import{d as v,c as C,r as c,a as j,j as e,g as S}from"./index-19290a20.js";import{m}from"./modal-2d4d4cf4.js";import"./sweetalert2.all-9dcc25ec.js";function E(){const u=v(t=>t.auth.user),{id:l}=C(),[i,x]=c.useState(null),[p,g]=c.useState(null),[b,y]=c.useState(""),[h,f]=c.useState(null),N=async()=>{var t,n,o,r;try{const a=await j.put(`http://localhost:3002/blog/addComment/${l}`,JSON.stringify({comment:b}),{withCredentials:!0});a.status&&(x(a.data.blog),g(a.data.blog.comments),m(a.data.status,"comment added",a.data.message),f(null),y(""))}catch(a){a&&m((n=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:n.status,"comment added",(r=(o=a==null?void 0:a.response)==null?void 0:o.data)==null?void 0:r.message)}},w=async t=>{var n,o,r,a;try{const s=await j.delete(`http://localhost:3002/blog/deleteComment/${l}?blogId=${t}`,{withCredentials:!0});s.status&&(x(s.data.blog),g(s.data.blog.comments),m(s.data.status,"comment deleted",s.data.message))}catch(s){s&&m((o=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:o.status,"comment deleted",(a=(r=s==null?void 0:s.response)==null?void 0:r.data)==null?void 0:a.message)}};return c.useEffect(()=>{let t=!0;return(async()=>{var n,o,r,a;try{const s="blog/getSingleBlog/",{data:d}=await j.get(`http://localhost:3002/${s}${l}`,{withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}});d.status&&t&&d.blog&&(x(d.blog),g(d.blog.comments))}catch(s){s&&m((o=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:o.status,"retive data",(a=(r=s==null?void 0:s.response)==null?void 0:r.data)==null?void 0:a.message)}})(),()=>{t=!1}},[l]),e.jsx("main",{className:"m-0 p-0 w-100 row mt-3",children:i?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"col-12 col-lg-8 d-flex mx-atuo justify-content-start align-items-start flex-column",children:[e.jsx("img",{className:"img-fluid rounded",style:{objectFit:"cover",objectPosition:"top center"},src:"http://localhost:3002/images/"+(i==null?void 0:i.image),alt:i==null?void 0:i.title}),e.jsx("h1",{className:"w-100 text-capitalize my-3 text-center",children:i.title}),e.jsx("h1",{className:"w-100 text-capitalize",children:i.sumary}),e.jsx("div",{dangerouslySetInnerHTML:{__html:i.content}})]}),e.jsx("div",{className:"col-12 col-lg-4 mx-atuo",children:e.jsxs("div",{className:"bg-dark rounded p-1",children:[e.jsx("p",{className:"text-primary text-capitalize text-start fs-3",children:"comments"}),p&&(p.length!==0?p.map(t=>{var n,o,r,a;return e.jsxs("div",{className:"w-100 d-flex justify-content-center align-items-start flex-column position-relative",children:[e.jsxs("div",{className:"w-100 d-flex justify-content-start",children:[e.jsxs("div",{className:"bg-white rounded-2 shadow-sm d-flex justify-content-start align-items-start flex-column bg-primary p-2",children:[e.jsx("img",{className:"img-fluid rounded-circle",style:{width:"80px",height:"80px",objectFit:"cover",objectPosition:"top center"},src:"http://localhost:3002/images/"+((n=t==null?void 0:t.user)==null?void 0:n.image),alt:(o=t==null?void 0:t.user)==null?void 0:o.name}),e.jsx("p",{className:"text-start text-capitalize text-center p-0 m-0",children:(r=t==null?void 0:t.user)==null?void 0:r.name})]}),e.jsx("p",{className:"flex-grow-1 text-start text-capitalize p-2 m-0",children:t==null?void 0:t.comment})]}),((a=t==null?void 0:t.user)==null?void 0:a._id.toString())===(u==null?void 0:u.toString())&&e.jsx("i",{className:"position-absolute bi bi-trash-fill text-danger top-0 end-0 pt-1 pointer",onClick:()=>{w(t==null?void 0:t._id)}}),e.jsx("hr",{className:"my-1 mx-0 w-100 bg-primary"})]},t==null?void 0:t._id)}):e.jsx("p",{className:"fs-5 text-capitalize text-center text-primary",children:"comments is empty"})),e.jsxs("form",{onSubmit:t=>{t.preventDefault(),h||N()},className:"mt-2 w-100 d-flex justify-content-between align-items-center",children:[e.jsx("input",{value:b,type:"text",onChange:t=>{y(t.target.value),/^[\w|\s]{3,}$/.test(t.target.value)?f(null):f("should be required at least 3char")},className:"border-1 flex-grow-1 me-1 p-1 rounded form-control",name:"",id:""}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"+add"})]}),h&&e.jsx("p",{className:"invalid-feedback",children:h})]})})]}):e.jsx(S,{classNamePropert:"loader"})})}export{E as default};
