import{r as p,c as I,d as E,u as F,a as w,j as t}from"./index-19290a20.js";import{c as $,a as D,u as R}from"./formik.esm-18368b5d.js";import{m as y}from"./modal-2d4d4cf4.js";import{S as B}from"./sweetalert2.all-9dcc25ec.js";import L from"./Loading-86366f05.js";function M({name:l}){const[u,v]=p.useState(null),{id:g}=I(),[b,h]=p.useState(),[j,N]=p.useState(),[f,C]=p.useState(null),x=E(e=>e.auth.auth),S=F(),k=$({name:D().matches(/\w{3,}/,"should has at least 3 character")}),r=R({initialValues:u||{name:null},enableReinitialize:!0,validationSchema:k,onSubmit:async e=>{var i,n,o,m;if(x)try{const a=new FormData;e.name&&a.append("name",e==null?void 0:e.name),j&&a.append("image",j);let c="category/updateCategory";l!=="category"&&(c="company/updateCompany");const s=await w.put(`http://localhost:3002/${c}/${g}`,a,{withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}});y(s.data.status,"Adding"+l,s.data.message).then(()=>{S(l==="category"?"/ecomerce/admin/categories":"/ecomerce/admin/companies")})}catch(a){a&&y((n=(i=a==null?void 0:a.response)==null?void 0:i.data)==null?void 0:n.status,"Adding Category",(m=(o=a==null?void 0:a.response)==null?void 0:o.data)==null?void 0:m.message)}else B.fire({title:"shuold be login first",icon:"error"})}});return p.useEffect(()=>{let e=!0;return(async()=>{var i,n,o,m,a,c;if(x)try{let s="category/getSingleCategory/";l!=="category"&&(s="company/getSingleCompany/");const{data:d}=await w.get(`http://localhost:3002/${s}${g}`,{withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}});d.status&&e&&d.data&&(v({name:(i=d.data)==null?void 0:i.name}),h("http://localhost:3002/images/"+((n=d.data)==null?void 0:n.image)))}catch(s){s&&y((m=(o=s==null?void 0:s.response)==null?void 0:o.data)==null?void 0:m.status,"retive data",(c=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:c.message)}})(),()=>{e=!1}},[g,l,x]),t.jsx("div",{className:"p-4 rounded-2 position-absolute top-0 start-0 bottom-0 end-0 bg-primary d-flex justify-content-center align-items-center flex-column",children:u?t.jsxs("form",{onSubmit:e=>{e.preventDefault(),r.handleSubmit()},className:"bg-light p-4 w-50",children:[t.jsxs("h1",{className:"text-primary text-start text-capitalize bg-light mb-3",children:["Edit ",l]}),t.jsxs("div",{className:"input-group mb-3",children:[t.jsx("label",{htmlFor:"exampleInputNameCategor1",className:"input-group-text",children:"Name"}),t.jsx("input",{type:"text",className:"form-control",value:r.values.name?r.values.name:"",name:"name",onChange:r.handleChange,onBlur:r.handleBlur,id:"exampleInputNameCategor1"}),t.jsx("div",{className:"invalid-feedback",children:r.touched.name&&r.errors.name&&r.errors.name})]}),t.jsxs("div",{className:"input-group mb-3",children:[t.jsx("label",{htmlFor:"exampleInputimageCategor1",className:"input-group-text",children:"image"}),t.jsx("input",{type:"file",className:"form-control",id:"exampleInputimageCategor1",onChange:e=>{if(e.target.files){const i=e.target.files[0],n=["image/jpeg","image/png","image/jpg"];if(i)if(n.includes(i.type)){const o=URL.createObjectURL(i);N(e.target.files[0]),h(o),C(null)}else h(null),N(null),C("invalid file only png jpg jpeg")}}}),t.jsx("div",{className:"invalid-feedback",children:f&&f})]}),b&&!f&&t.jsx("img",{src:b,style:{width:"150px",height:"150px",display:"block",marginBottom:"10px"},alt:"presonal Image"}),t.jsx("button",{type:"submit",className:"btn btn-primary w-100",children:"Submit"})]}):t.jsx(L,{classNamePropert:""})})}export{M as default};
