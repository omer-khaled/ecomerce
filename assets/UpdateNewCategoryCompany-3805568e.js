import{r as p,c as I,d as E,u as F,a as w,j as t}from"./index-99225c5a.js";import{c as $,a as D,u as R}from"./formik.esm-61ab1a81.js";import{m as y}from"./modal-ce0b874b.js";import{S as B}from"./sweetalert2.all-7a2e22d8.js";import L from"./Loading-b14edf56.js";function M({name:m}){const[u,v]=p.useState(null),{id:g}=I(),[b,f]=p.useState(),[j,N]=p.useState(),[h,C]=p.useState(null),x=E(e=>e.auth.auth),S=F(),k=$({name:D().matches(/\w{3,}/,"should has at least 3 character")}),i=R({initialValues:u||{name:null},enableReinitialize:!0,validationSchema:k,onSubmit:async e=>{var r,n,o,l;if(x)try{const a=new FormData;e.name&&a.append("name",e==null?void 0:e.name),j&&a.append("image",j);let c="category/updateCategory";m!=="category"&&(c="company/updateCompany");const s=await w.put(`https://ecomerce-kmcp.onrender.com/${c}/${g}`,a,{withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}});y(s.data.status,"Adding"+m,s.data.message).then(()=>{S(m==="category"?"/ecomerce/admin/categories":"/ecomerce/admin/companies")})}catch(a){a&&y((n=(r=a==null?void 0:a.response)==null?void 0:r.data)==null?void 0:n.status,"Adding Category",(l=(o=a==null?void 0:a.response)==null?void 0:o.data)==null?void 0:l.message)}else B.fire({title:"shuold be login first",icon:"error"})}});return p.useEffect(()=>{let e=!0;return(async()=>{var r,n,o,l,a,c;if(x)try{let s="category/getSingleCategory/";m!=="category"&&(s="company/getSingleCompany/");const{data:d}=await w.get(`https://ecomerce-kmcp.onrender.com/${s}${g}`,{withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}});d.status&&e&&d.data&&(v({name:(r=d.data)==null?void 0:r.name}),f("https://ecomerce-kmcp.onrender.com/images/"+((n=d.data)==null?void 0:n.image)))}catch(s){s&&y((l=(o=s==null?void 0:s.response)==null?void 0:o.data)==null?void 0:l.status,"retive data",(c=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:c.message)}})(),()=>{e=!1}},[g,m,x]),t.jsx("div",{className:"p-4 rounded-2 position-absolute top-0 start-0 bottom-0 end-0 bg-primary d-flex justify-content-center align-items-center flex-column",children:u?t.jsxs("form",{onSubmit:e=>{e.preventDefault(),i.handleSubmit()},className:"bg-light p-4 w-50",children:[t.jsxs("h1",{className:"text-primary text-start text-capitalize bg-light mb-3",children:["Edit ",m]}),t.jsxs("div",{className:"input-group mb-3",children:[t.jsx("label",{htmlFor:"exampleInputNameCategor1",className:"input-group-text",children:"Name"}),t.jsx("input",{type:"text",className:"form-control",value:i.values.name?i.values.name:"",name:"name",onChange:i.handleChange,onBlur:i.handleBlur,id:"exampleInputNameCategor1"}),t.jsx("div",{className:"invalid-feedback",children:i.touched.name&&i.errors.name&&i.errors.name})]}),t.jsxs("div",{className:"input-group mb-3",children:[t.jsx("label",{htmlFor:"exampleInputimageCategor1",className:"input-group-text",children:"image"}),t.jsx("input",{type:"file",className:"form-control",id:"exampleInputimageCategor1",onChange:e=>{if(e.target.files){const r=e.target.files[0],n=["image/jpeg","image/png","image/jpg"];if(r)if(n.includes(r.type)){const o=URL.createObjectURL(r);N(e.target.files[0]),f(o),C(null)}else f(null),N(null),C("invalid file only png jpg jpeg")}}}),t.jsx("div",{className:"invalid-feedback",children:h&&h})]}),b&&!h&&t.jsx("img",{src:b,style:{width:"150px",height:"150px",display:"block",marginBottom:"10px"},alt:"presonal Image"}),t.jsx("button",{type:"submit",className:"btn btn-primary w-100",children:"Submit"})]}):t.jsx(L,{classNamePropert:""})})}export{M as default};
