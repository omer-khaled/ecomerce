import{r,a as h,j as s,L as m}from"./index-19290a20.js";import j from"./Loading-86366f05.js";import{S as d}from"./sweetalert2.all-9dcc25ec.js";import{a as f}from"./adminGards-99dc29e6.js";const u=r.createContext({requestDone:!1,setRequestDone:()=>{}});function p(){const[e,c]=r.useState(!1),[o,n]=r.useState(null);return r.useEffect(()=>{let x=!0;return(async()=>{try{n(()=>null);const{data:i}=await h.get("http://localhost:3002/order/AdmingetOrders");i.orders&&x&&n(i.orders)}catch(i){d.fire({title:"error through retrived Data",text:i.message,icon:"error"})}})(),()=>{x=!1}},[e]),s.jsx(u.Provider,{value:{requestDone:e,setRequestDone:c},children:s.jsx(y,{admin:!0,orders:o})})}const g=f(p),w=Object.freeze(Object.defineProperty({__proto__:null,Orders:p,context:u,default:g},Symbol.toStringTag,{value:"Module"}));function y({orders:e,admin:c}){const{requestDone:o,setRequestDone:n}=r.useContext(u),x=r.useCallback(async t=>{try{const{data:a}=await h.get(`http://localhost:3002/cart/checkoutForExistsOrder/${t}?cancel_url=https://omer-khaled.github.io/ecomerce/failedPage&success_url=https://omer-khaled.github.io/ecomerce/successPage`,{headers:{"Content-Type":"application/json"},withCredentials:!0});a.url?d.fire({title:"Payment Ready For You",text:"Go To Payment",icon:"success"}).then(()=>{a.url&&(location.href=a.url)}):d.fire({title:"Cart is Empaty!",text:a.message,icon:"error"})}catch{}},[]),i=r.useCallback(async t=>{try{const{data:a}=await h.patch(`http://localhost:3002/order/updateStatusOrder/${t}`,{headers:{"Content-Type":"application/json"},withCredentials:!0});a.status?(d.fire({title:"Status updated Successfully",text:"Done",icon:"success"}),n(!o)):d.fire({title:"Status updated failed",text:a.message,icon:"error"})}catch{window.location.href="http://localhost:5173/failedPage"}},[o,n]);return s.jsx("section",{className:"row w-100 m-0 flex-grow-1 align-items-start my-4 ",children:e?e.length!==0?s.jsx("div",{className:"table-responsive",children:s.jsxs("table",{className:"table align-middle",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[c&&s.jsx("th",{children:"actions"}),s.jsx("th",{children:"orderId"}),s.jsx("th",{children:"cart Details"}),s.jsx("th",{children:"order satus"}),s.jsx("th",{children:"paid"}),s.jsx("th",{children:"total"}),s.jsx("th",{children:"payment status"}),s.jsx("th",{children:"Time"}),s.jsx("th",{children:"Date"})]})}),s.jsx("tbody",{children:e==null?void 0:e.map(t=>s.jsxs("tr",{children:[c&&((t==null?void 0:t.status)!=="Delivered"?s.jsx("td",{className:`text-capitalize ${t!=null&&t.paid?"text-success":"text-danger"}`,children:s.jsxs("div",{className:"w-100 d-flex justify-content-start align-items-center",children:[(t==null?void 0:t.status)==="in store"&&s.jsx("i",{className:"bi bi-truck me-2 pointer",onClick:()=>{i(t==null?void 0:t._id)}}),(t==null?void 0:t.status)==="in shipping"&&s.jsx("i",{className:"bi bi-check2-circle pointer",onClick:()=>{i(t==null?void 0:t._id)}})]})}):s.jsx("td",{className:`text-capitalize ${t!=null&&t.paid?"text-success":"text-danger"}`,children:"Successfully"})),s.jsx("td",{onClick:()=>{!c&&!(t!=null&&t.paid)&&x(t==null?void 0:t._id)},className:`text-capitalize ${t!=null&&t.paid?"text-success":"text-danger"} pointer`,children:t==null?void 0:t._id}),s.jsx("td",{className:`text-capitalize ${t!=null&&t.paid?"text-success":"text-danger"}`,children:s.jsx(m,{to:`/${c?"admin/ordersCartAdmin":"ordersCart"}/${t==null?void 0:t._id}`,children:"cart details"})}),s.jsx("td",{className:`text-capitalize ${t!=null&&t.paid?"text-success":"text-danger"}`,children:t==null?void 0:t.status}),s.jsx("td",{className:`text-capitalize ${t!=null&&t.paid?"text-success":"text-danger"}`,children:String(t==null?void 0:t.paid)}),s.jsxs("td",{className:`text-capitalize ${t!=null&&t.paid?"text-success":"text-danger"}`,children:[String(t==null?void 0:t.totalPrice)," $"]}),s.jsxs("td",{className:`text-capitalize ${t!=null&&t.paid?"text-success":"text-danger"}`,children:[t==null?void 0:t.paymentStatus," ",t!=null&&t.paid?s.jsx("i",{className:"bi bi-check-all"}):s.jsx("i",{className:"bi bi-x"})]}),s.jsx("td",{className:`text-capitalize ${t!=null&&t.paid?"text-success":"text-danger"}`,children:new Date(t==null?void 0:t.createdAt).toLocaleTimeString()}),s.jsx("td",{className:`text-capitalize ${t!=null&&t.paid?"text-success":"text-danger"}`,children:new Date(t==null?void 0:t.createdAt).toLocaleDateString()})]},t==null?void 0:t._id))})]})}):s.jsx("h1",{className:"text-center w-100 text-primary text-capitalize",children:"no orders for now"}):s.jsx(j,{classNamePropert:""})})}export{y as O,w as a};
