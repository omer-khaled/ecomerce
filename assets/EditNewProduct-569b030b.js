import{c as P,r as i,u as $,d as D,a as N,j as e}from"./index-d8365773.js";import{c as T,a as o,b as k,d as C,u as R}from"./formik.esm-e9f1fb19.js";import{m as S}from"./modal-31c571c1.js";import{S as _}from"./sweetalert2.all-c4fbba39.js";import A from"./Loading-550ccbaf.js";function J(){const{id:d}=P(),[m,w]=i.useState(null),[h,x]=i.useState(null),[g,b]=i.useState(null),[j,p]=i.useState(),[B,f]=i.useState(),[u,v]=i.useState(null),F=$(),z=D(t=>t.auth.auth),q=t=>{a.values.colors.length!==5?a.values.colors.find(r=>r===t)||a.setFieldValue("colors",[...a.values.colors,t]):a.setFieldError("colors","maximum number of colors")},I=T({title:o().required("required Feild").matches(/\w{4,}/,"should has at least 3 character"),description:o().required("required Feild").matches(/\w{4,}/,"should has at least 3 character"),price:k().required("required Feild").min(0,"should be positive number"),inStock:k().required("required Feild").min(0,"should be positive number"),company:o().required("required Feild").min(24,"should be positive number").max(24,"should be positive number"),category:o().required("required Feild").min(24,"should be positive number").max(24,"should be positive number"),sizes:C().required("required Feild"),colors:C().required("required Feild")}),a=R({initialValues:m||{title:"",description:"",price:0,inStock:0,company:"",category:"",sizes:[],colors:[]},enableReinitialize:!0,validationSchema:I,onSubmit:async t=>{var n,r,l,c;if(z)try{const s=new FormData;s.append("title",t.title),s.append("description",t.description),s.append("price",`${t.price}`),s.append("inStock",`${t.inStock}`),s.append("company",t.company),s.append("category",t.category),s.append("sizes",JSON.stringify(t.sizes)),s.append("colors",JSON.stringify(t.colors)),s.append("image",B);const E=`/products/updateProduct/${d}`,y=await N.put(`https://ecomerce-kmcp.onrender.com${E}`,s,{withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}});S(y.data.status,"Adding Products",y.data.message).then(()=>{F("/ecomerce/admin/products")})}catch(s){s&&S((r=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:r.status,"update Product",(c=(l=s==null?void 0:s.response)==null?void 0:l.data)==null?void 0:c.message)}else _.fire({title:"shuold be login first",icon:"error"})}});return i.useEffect(()=>{let t=!0;return async function(){const r=await(await fetch("https://ecomerce-kmcp.onrender.com/category/getCategories",{method:"GET",headers:{"Content-Type":"application/json"}})).json(),l=await(await fetch("https://ecomerce-kmcp.onrender.com/company/getCompany",{method:"GET",headers:{"Content-Type":"application/json"}})).json(),{data:c}=await N.get(`https://ecomerce-kmcp.onrender.com/products/getSingleProduct/${d}`,{withCredentials:!0});t&&c.product&&(x(r.categories),b(l.companies),w(c.product),p("https://ecomerce-kmcp.onrender.com/images/"+c.product.imageUrl))}(),()=>{t=!1}},[x,b,d]),e.jsx("div",{className:"p-4 rounded-2 position-absolute top-0 start-0 bottom-0 end-0 bg-primary d-flex justify-content-center align-items-center flex-column",children:m?e.jsxs("form",{onSubmit:t=>{t.preventDefault(),a.handleSubmit()},className:"bg-light p-4 w-100",children:[e.jsx("h1",{className:"text-primary text-start text-capitalize bg-light mb-3",children:"Edit Prodcut"}),e.jsxs("div",{className:"row justify-content-between mb-3",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"exampleInputtitle",className:"input-group-text",children:"Title"}),e.jsx("input",{type:"text",value:a.values.title||"",className:"form-control",name:"title",onChange:a.handleChange,onBlur:a.handleBlur,id:"exampleInputtitle"}),e.jsx("div",{className:"invalid-feedback",children:a.touched.title&&a.errors.title&&a.errors.title})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"col-5 input-group",children:[e.jsx("label",{htmlFor:"exampleInputdescription",className:"input-group-text",children:"Description"}),e.jsx("input",{type:"text",className:"form-control",value:a.values.description||"",name:"description",onChange:a.handleChange,onBlur:a.handleBlur,id:"exampleInputdescription"}),e.jsx("div",{className:"invalid-feedback",children:a.touched.description&&a.errors.description&&a.errors.description})]})})]}),e.jsxs("div",{className:"row justify-content-between mb-3",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"exampleInputprice",className:"input-group-text",children:"Price"}),e.jsx("input",{type:"text",className:"form-control",value:a.values.price||"",name:"price",onChange:a.handleChange,onBlur:a.handleBlur,id:"exampleInputprice"}),e.jsx("div",{className:"invalid-feedback",children:a.touched.price&&a.errors.price&&a.errors.price})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"exampleInputinStock",className:"input-group-text",children:"InStock"}),e.jsx("input",{type:"text",className:"form-control",name:"inStock",value:a.values.inStock||"",onChange:a.handleChange,onBlur:a.handleBlur,id:"exampleInputinStock"}),e.jsx("div",{className:"invalid-feedback",children:a.touched.inStock&&a.errors.inStock&&a.errors.inStock})]})})]}),e.jsxs("div",{className:"row justify-content-between mb-3",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"exampleInputcompany",className:"input-group-text",children:"Company"}),e.jsxs("select",{className:"form-select",value:a.values.category||"",name:"category",onChange:a.handleChange,onBlur:a.handleBlur,children:[e.jsx("option",{children:"choose category"}),h&&h.map(t=>e.jsx("option",{value:t==null?void 0:t._id,children:t==null?void 0:t.name},t==null?void 0:t._id))]}),e.jsx("div",{className:"invalid-feedback",children:a.touched.category&&a.errors.category&&a.errors.category})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"exampleInputcompany",className:"input-group-text",children:"Company"}),e.jsxs("select",{className:"form-select",name:"company",value:a.values.company||"",onChange:a.handleChange,onBlur:a.handleBlur,children:[e.jsx("option",{children:"choose company"}),g&&g.map(t=>e.jsx("option",{value:t==null?void 0:t._id,children:t==null?void 0:t.name},t==null?void 0:t._id))]}),e.jsx("div",{className:"invalid-feedback",children:a.touched.company&&a.errors.company&&a.errors.company})]})})]}),e.jsxs("div",{className:"btn-group mb-3",role:"group","aria-label":"Basic checkbox toggle button group",children:[e.jsx("input",{type:"checkbox",name:"sizes",checked:!!a.values.sizes.find(t=>t==="s"),className:"btn-check",id:"btncheck1",value:"s",onChange:a.handleChange,onBlur:a.handleBlur}),e.jsx("label",{className:"btn btn-outline-primary text-black",htmlFor:"btncheck1",children:"small"}),e.jsx("input",{type:"checkbox",name:"sizes",checked:!!a.values.sizes.find(t=>t==="m"),className:"btn-check",id:"btncheck2",value:"m",onChange:a.handleChange,onBlur:a.handleBlur}),e.jsx("label",{className:"btn btn-outline-primary text-black",htmlFor:"btncheck2",children:"mediumn"}),e.jsx("input",{type:"checkbox",name:"sizes",checked:!!a.values.sizes.find(t=>t==="l"),className:"btn-check",id:"btncheck3",value:"l",onChange:a.handleChange,onBlur:a.handleBlur}),e.jsx("label",{className:"btn btn-outline-primary text-black",htmlFor:"btncheck3",children:"large"}),e.jsx("input",{type:"checkbox",name:"sizes",className:"btn-check",checked:!!a.values.sizes.find(t=>t==="xl"),id:"btncheck4",value:"xl",onChange:a.handleChange,onBlur:a.handleBlur}),e.jsx("label",{className:"btn btn-outline-primary text-black",htmlFor:"btncheck4",children:"Xlarge"})]}),e.jsx("div",{className:"invalid-feedback",children:a.touched.sizes&&a.errors.sizes&&a.errors.sizes}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"colroExmaple",className:"pe-2 text-capitalize",children:e.jsx("strong",{children:"choose color :"})}),e.jsx("input",{type:"color",className:"",name:"colors",onChange:t=>{q(t.target.value)},onBlur:a.handleBlur,id:"colroExmaple"}),e.jsx("div",{className:"invalid-feedback",children:a.errors.colors&&a.errors.colors})]}),e.jsxs("div",{children:[e.jsxs("strong",{children:["Selected Colors :",e.jsx("span",{className:"text-success",children:" can clicked on color to delete it"})]}),e.jsx("div",{className:"w-100 overflow-auto d-flex flex-nowrap flex-row justify-content-start align-items-center",children:a.values.colors.length>0?a.values.colors.map((t,n)=>e.jsx("span",{onClick:()=>{a.setFieldValue("colors",a.values.colors.filter(r=>r!==t))},style:{backgroundColor:t,width:"20px",height:"20px",marginRight:"2px"}},n)):e.jsx("p",{className:"text-danger m-0 p-0",children:"plz select colors"})})]})]}),e.jsxs("div",{className:"input-group mb-3",children:[e.jsx("label",{htmlFor:"exampleInputimageCategor1",className:"input-group-text",children:"image"}),e.jsx("input",{type:"file",className:"form-control",id:"exampleInputimageCategor1",onChange:t=>{if(t.target.files){const n=t.target.files[0],r=["image/jpeg","image/png","image/jpg"];if(n)if(r.includes(n.type)){const l=URL.createObjectURL(n);f(t.target.files[0]),p(l),v(null)}else p(null),f(null),v("invalid file only png jpg jpeg")}}}),e.jsx("div",{className:"invalid-feedback",children:u&&u})]}),j&&!u&&e.jsx("img",{src:j,style:{width:"150px",height:"150px",display:"block",marginBottom:"10px"},alt:"presonal Image"}),e.jsx("button",{type:"submit",className:"btn btn-primary w-100",children:"Submit"})]}):e.jsx(A,{classNamePropert:""})})}export{J as default};
