import{r as o,u as q,d as I,j as e,a as z}from"./index-3ab9dcaf.js";import{c as E,a as l,b as y,d as v,u as $}from"./formik.esm-017c7e04.js";import{m as k}from"./modal-aa3e5616.js";import{S as A}from"./sweetalert2.all-aae1b3ab.js";function _(){const[m,p]=o.useState(null),[u,h]=o.useState(null),[x,g]=o.useState(),[b,j]=o.useState(),[c,d]=o.useState(null),C=q(),F=I(t=>t.auth.auth),S=t=>{a.values.colors.length!==5?a.values.colors.find(n=>n===t)||a.setFieldValue("colors",[...a.values.colors,t]):a.setFieldError("colors","maximum number of colors")},w=E({title:l().required("required Feild").matches(/\w{4,}/,"should has at least 3 character"),description:l().required("required Feild").matches(/\w{4,}/,"should has at least 3 character"),price:y().required("required Feild").min(0,"should be positive number"),inStock:y().required("required Feild").min(0,"should be positive number"),company:l().required("required Feild").min(24,"should be positive number").max(24,"should be positive number"),category:l().required("required Feild").min(24,"should be positive number").max(24,"should be positive number"),sizes:v().required("required Feild"),colors:v().required("required Feild")}),a=$({initialValues:{title:"",description:"",price:0,inStock:0,company:"",category:"",sizes:[],colors:[]},validationSchema:w,onSubmit:async t=>{var r,n,i,f;if(F)try{console.log(t);const s=new FormData;if(!b)return d("required feild");s.append("title",t.title),s.append("description",t.description),s.append("price",`${t.price}`),s.append("inStock",`${t.inStock}`),s.append("company",t.company),s.append("category",t.category),s.append("sizes",JSON.stringify(t.sizes)),s.append("colors",JSON.stringify(t.colors)),s.append("image",b);const B="/products/addproduct",N=await z.post(`https://ecomerce-kmcp.onrender.com${B}`,s,{withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}});k(N.data.status,"Adding Products",N.data.message).then(()=>{C("/ecomerce/admin/products")})}catch(s){s&&k((n=(r=s==null?void 0:s.response)==null?void 0:r.data)==null?void 0:n.status,"Adding Product",(f=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:f.message)}else A.fire({title:"shuold be login first",icon:"error"})}});return o.useEffect(()=>{let t=!0;return async function(){const n=await(await fetch("https://ecomerce-kmcp.onrender.com/category/getCategories",{method:"GET",headers:{"Content-Type":"application/json"}})).json(),i=await(await fetch("https://ecomerce-kmcp.onrender.com/company/getCompany",{method:"GET",headers:{"Content-Type":"application/json"}})).json();t&&(p(n.categories),h(i.companies))}(),()=>{t=!1}},[p,h]),e.jsx("div",{className:"p-4 rounded-2 position-absolute top-0 start-0 bottom-0 end-0 bg-primary d-flex justify-content-center align-items-center flex-column",children:e.jsxs("form",{onSubmit:t=>{t.preventDefault(),a.handleSubmit()},className:"bg-light p-4 w-100",children:[e.jsx("h1",{className:"text-primary text-start text-capitalize bg-light mb-3",children:"Add Prodcut"}),e.jsxs("div",{className:"row justify-content-between mb-3",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"exampleInputtitle",className:"input-group-text",children:"Title"}),e.jsx("input",{type:"text",className:"form-control",name:"title",onChange:a.handleChange,onBlur:a.handleBlur,id:"exampleInputtitle"}),e.jsx("div",{className:"invalid-feedback",children:a.touched.title&&a.errors.title&&a.errors.title})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"col-5 input-group",children:[e.jsx("label",{htmlFor:"exampleInputdescription",className:"input-group-text",children:"Description"}),e.jsx("input",{type:"text",className:"form-control",name:"description",onChange:a.handleChange,onBlur:a.handleBlur,id:"exampleInputdescription"}),e.jsx("div",{className:"invalid-feedback",children:a.touched.description&&a.errors.description&&a.errors.description})]})})]}),e.jsxs("div",{className:"row justify-content-between mb-3",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"exampleInputprice",className:"input-group-text",children:"Price"}),e.jsx("input",{type:"text",className:"form-control",name:"price",onChange:a.handleChange,onBlur:a.handleBlur,id:"exampleInputprice"}),e.jsx("div",{className:"invalid-feedback",children:a.touched.price&&a.errors.price&&a.errors.price})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"exampleInputinStock",className:"input-group-text",children:"InStock"}),e.jsx("input",{type:"text",className:"form-control",name:"inStock",onChange:a.handleChange,onBlur:a.handleBlur,id:"exampleInputinStock"}),e.jsx("div",{className:"invalid-feedback",children:a.touched.inStock&&a.errors.inStock&&a.errors.inStock})]})})]}),e.jsxs("div",{className:"row justify-content-between mb-3",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"exampleInputcompany",className:"input-group-text",children:"Company"}),e.jsxs("select",{className:"form-select",name:"category",onChange:a.handleChange,onBlur:a.handleBlur,children:[e.jsx("option",{children:"choose category"}),m&&m.map(t=>e.jsx("option",{value:t==null?void 0:t._id,children:t==null?void 0:t.name},t==null?void 0:t._id))]}),e.jsx("div",{className:"invalid-feedback",children:a.touched.category&&a.errors.category&&a.errors.category})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"exampleInputcompany",className:"input-group-text",children:"Company"}),e.jsxs("select",{className:"form-select",name:"company",onChange:a.handleChange,onBlur:a.handleBlur,children:[e.jsx("option",{children:"choose company"}),u&&u.map(t=>e.jsx("option",{value:t==null?void 0:t._id,children:t==null?void 0:t.name},t==null?void 0:t._id))]}),e.jsx("div",{className:"invalid-feedback",children:a.touched.company&&a.errors.company&&a.errors.company})]})})]}),e.jsxs("div",{className:"btn-group mb-3",role:"group","aria-label":"Basic checkbox toggle button group",children:[e.jsx("input",{type:"checkbox",name:"sizes",className:"btn-check",id:"btncheck1",value:"s",onChange:a.handleChange,onBlur:a.handleBlur}),e.jsx("label",{className:"btn btn-outline-primary text-black",htmlFor:"btncheck1",children:"small"}),e.jsx("input",{type:"checkbox",name:"sizes",className:"btn-check",id:"btncheck2",value:"m",onChange:a.handleChange,onBlur:a.handleBlur}),e.jsx("label",{className:"btn btn-outline-primary text-black",htmlFor:"btncheck2",children:"mediumn"}),e.jsx("input",{type:"checkbox",name:"sizes",className:"btn-check",id:"btncheck3",value:"l",onChange:a.handleChange,onBlur:a.handleBlur}),e.jsx("label",{className:"btn btn-outline-primary text-black",htmlFor:"btncheck3",children:"large"}),e.jsx("input",{type:"checkbox",name:"sizes",className:"btn-check",id:"btncheck4",value:"xl",onChange:a.handleChange,onBlur:a.handleBlur}),e.jsx("label",{className:"btn btn-outline-primary text-black",htmlFor:"btncheck4",children:"Xlarge"})]}),e.jsx("div",{className:"invalid-feedback",children:a.touched.sizes&&a.errors.sizes&&a.errors.sizes}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"colroExmaple",className:"pe-2 text-capitalize",children:e.jsx("strong",{children:"choose color :"})}),e.jsx("input",{type:"color",className:"",name:"colors",onChange:t=>{S(t.target.value)},onBlur:a.handleBlur,id:"colroExmaple"}),e.jsx("div",{className:"invalid-feedback",children:a.errors.colors&&a.errors.colors})]}),e.jsxs("div",{children:[e.jsxs("strong",{children:["Selected Colors :",e.jsx("span",{className:"text-success",children:" can clicked on color to delete it"})]}),e.jsx("div",{className:"w-100 overflow-auto d-flex flex-nowrap flex-row justify-content-start align-items-center",children:a.values.colors.length>0?a.values.colors.map((t,r)=>e.jsx("span",{onClick:()=>{a.setFieldValue("colors",a.values.colors.filter(n=>n!==t))},style:{backgroundColor:t,width:"20px",height:"20px",marginRight:"2px"}},r)):e.jsx("p",{className:"text-danger m-0 p-0",children:"plz select colors"})})]})]}),e.jsxs("div",{className:"input-group mb-3",children:[e.jsx("label",{htmlFor:"exampleInputimageCategor1",className:"input-group-text",children:"image"}),e.jsx("input",{type:"file",className:"form-control",id:"exampleInputimageCategor1",onChange:t=>{if(t.target.files){const r=t.target.files[0],n=["image/jpeg","image/png","image/jpg"];if(r)if(n.includes(r.type)){const i=URL.createObjectURL(r);j(t.target.files[0]),g(i),d(null)}else g(null),j(null),d("invalid file only png jpg jpeg")}}}),e.jsx("div",{className:"invalid-feedback",children:c&&c})]}),x&&!c&&e.jsx("img",{src:x,style:{width:"150px",height:"150px",display:"block",marginBottom:"10px"},alt:"presonal Image"}),e.jsx("button",{type:"submit",className:"btn btn-primary w-100",children:"Submit"})]})})}export{_ as default};
